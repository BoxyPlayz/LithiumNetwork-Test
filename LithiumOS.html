<html><head><title>LithiumOS</title>
<link rel="icon" type="image/png" href="https://res.cloudinary.com/dguh1n4hz/image/upload/v1722713581/favicon.ico">
<style>
  :root {
    --primary-color: #80ff44;
    --secondary-color: #0F0F0F;
    --border-radius: 12px;
  }
  
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: 'Roboto', sans-serif;
    background: var(--secondary-color);
    color: white;
    overflow: hidden;
  }
  
  #desktop {
    height: 100%;
    display: flex;
    flex-direction: column;
  }
  
  #taskbar {
    background: rgba(15, 15, 15, 0.8);
    padding: 10px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top: 2px solid var(--primary-color);
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
  }
  
  #start-menu {
    background: var(--primary-color);
    color: var(--secondary-color);
    padding: 8px 16px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease;
  }
  
  #start-menu:hover {
    background: #66cc33;
  }
  
  #clock {
    font-size: 14px;
    font-weight: bold;
  }
  
  #desktop-icons {
    display: flex;
    flex-wrap: wrap;
    padding: 20px;
    gap: 20px;
  }
  
  .icon {
    width: 80px;
    height: 80px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--border-radius);
    transition: all 0.3s ease;
  }
  
  .icon:hover {
    background: rgba(128, 255, 68, 0.2);
  }
  
  .icon svg {
    width: 40px;
    height: 40px;
    fill: var(--primary-color);
  }
  
  .icon-label {
    font-size: 12px;
    margin-top: 5px;
    text-align: center;
  }
  
  .app-window {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80%;
    height: 80%;
    background: rgba(15, 15, 15, 1);
    border-radius: var(--border-radius);
    border: 2px solid var(--primary-color);
    display: none;
    flex-direction: column;
    overflow: hidden;
    min-width: 300px; /* Minimum width */
    min-height: 200px; /* Minimum height */
    max-width: 90%; /* Maximum width */
    max-height: 90%; /* Maximum height */
  }
  
  .app-header {
    background: var(--primary-color);
    color: var(--secondary-color);
    padding: 5px 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
    cursor: move;
  }
  
  .app-controls {
    display: flex;
    gap: 10px;
  }
  
  .app-control {
    background: none;
    border: none;
    color: var(--secondary-color);
    font-size: 16px;
    cursor: pointer;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
  }
  
  .app-control:hover {
    background: rgba(0, 0, 0, 0.1);
  }
  
  .app-content {
    flex-grow: 1;
    padding: 20px;
    overflow: hidden;
  }

  .app-window {
    resize: both;
  }

  .app-window .app-header:hover {
    cursor: move;
  }

  .app-window .resize-handle {
    position: absolute;
    width: 10px;
    height: 10px;
  }

  .app-window .resize-handle.top-left {
    top: 0;
    left: 0;
    cursor: nwse-resize;
  }

  .app-window .resize-handle.top-right {
    top: 0;
    right: 0;
    cursor: nesw-resize;
  }

  .app-window .resize-handle.bottom-left {
    bottom: 0;
    left: 0;
    cursor: nesw-resize;
  }

  .app-window .resize-handle.bottom-right {
    bottom: 0;
    right: 0;
    cursor: nwse-resize;
  }

  .app-window .resize-handle.top {
    top: 0;
    left: 10px;
    right: 10px;
    height: 5px;
    cursor: ns-resize;
  }

  .app-window .resize-handle.bottom {
    bottom: 0;
    left: 10px;
    right: 10px;
    height: 5px;
    cursor: ns-resize;
  }

  .app-window .resize-handle.left {
    left: 0;
    top: 10px;
    bottom: 10px;
    width: 5px;
    cursor: ew-resize;
  }

  .app-window .resize-handle.right {
    right: 0;
    top: 10px;
    bottom: 10px;
    width: 5px;
    cursor: ew-resize;
  }

  .media-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin-top: 10px;
  }

  .media-controls button {
    background: var(--primary-color);
    color: var(--secondary-color);
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
  }

  .media-controls button:hover {
    background: #66cc33;
  }

  #textEditor {
    width: 100%;
    height: 300px;
    background: var(--secondary-color);
    color: white;
    border: 1px solid var(--primary-color);
    padding: 10px;
    font-family: monospace;
  }

  .file-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100px;
    height: 100px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--border-radius);
    margin-bottom: 10px;
    transition: all 0.3s ease;
    position: relative;
  }

  .file-item:hover {
    background: rgba(128, 255, 68, 0.2);
  }

  .file-item img {
    max-width: 50px;
    max-height: 50px;
    margin-bottom: 5px;
  }

  .file-item input[type="checkbox"] {
    position: absolute;
    top: 5px;
    right: 5px;
  }

  .file-item button {
    background: var(--primary-color);
    color: var(--secondary-color);
    border: none;
    padding: 5px 10px;
    border-radius: var(--border-radius);
    cursor: pointer;
    margin-left: 5px;
  }

  .file-item button:hover {
    background: #66cc33;
  }

  /* Stylish buttons and text boxes */
  .stylish-button {
    background: var(--primary-color);
    color: var(--secondary-color);
    padding: 8px 16px;
    border-radius: var(--border-radius);
    border: none;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease;
  }

  .stylish-button:hover {
    background: #66cc33;
  }
  .stylish-input {
    background: var(--secondary-color);
    color: #80ff44;
    padding: 8px;
    border-radius: var(--border-radius);
    font-family: 'Roboto', sans-serif;
    transition: all 0.3s ease;
    border: none; /* Remove the gray bar on the bottom of the text box */
  }

  .stylish-input:focus {
    outline: none;
  }

  /* Stylish file input */
  .stylish-file-input {
    display: none;
  }

  .stylish-file-label {
    background: var(--primary-color);
    color: var(--secondary-color);
    padding: 8px 16px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease;
    display: inline-block;
  }

  .stylish-file-label:hover {
    background: #66cc33;
  }
</style>
<script>
  !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys getNextSurveyStep onSessionId setPersonProperties".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
  posthog.init('phc_Rgd0heNESFjABIT2HT3ZBxPbcITKeIvlS6RZKGGrgk8',{api_host:'https://us.i.posthog.com', person_profiles: 'identified_only' // or 'always' to create profiles for anonymous users as well
      })
</script>
</head>
<body>
  <div id="desktop">
    <div id="desktop-icons">
      <div class="icon" onclick="openApp('app store')">
        <svg viewBox="0 0 24 24">
          <path d="M12,18H6V14H12M21,14V12L20,7H4L3,12V14H4V20H14V14H18V20H20V14M20,4H4V6H20V4Z" />
        </svg>
        <div class="icon-label">App Store</div>
      </div>
      <div class="icon" onclick="openApp('games')">
        <svg viewBox="0 0 24 24">
          <path d="M21,6H3A2,2 0 0,0 1,8V16A2,2 0 0,0 3,18H21A2,2 0 0,0 23,16V8A2,2 0 0,0 21,6M21,16H3V8H21M6,15H8V13H10V11H8V9H6V11H4V13H6M14.5,12A1.5,1.5 0 0,1 16,13.5A1.5,1.5 0 0,1 14.5,15A1.5,1.5 0 0,1 13,13.5A1.5,1.5 0 0,1 14.5,12M18.5,9A1.5,1.5 0 0,1 20,10.5A1.5,1.5 0 0,1 18.5,12A1.5,1.5 0 0,1 17,10.5A1.5,1.5 0 0,1 18.5,9Z" />
        </svg>
        <div class="icon-label">Games</div>
      </div>
      <div class="icon" onclick="openApp('files')">
        <svg viewBox="0 0 24 24">
          <path d="M20,18H4V8H20M20,6H12L10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6Z" />
        </svg>
        <div class="icon-label">Files</div>
      </div>
      <div class="icon" onclick="openApp('CMD')">
<svg xmlns="http://www.w3.org/2000/svg" version="1.0" viewBox="0 0 948 948"><path fill-opacity=".1" d="M364 483.5c18.4 18.4 33.7 33.5 34 33.5s-14.6-15.1-33-33.5-33.7-33.5-34-33.5 14.6 15.1 33 33.5m-60 79.2-21.5 21.8 21.8-21.5c20.2-20 22.2-22 21.4-22-.1 0-9.9 9.8-21.7 21.7M165 740.4c0 .2.8 1 1.8 1.7 1.5 1.3 1.6 1.2.3-.4s-2.1-2.1-2.1-1.3"/><path fill-opacity=".2" d="M775 200.3c0 .2 1.5 1.6 3.3 3.3l3.2 2.9-2.9-3.3c-2.8-3-3.6-3.7-3.6-2.9m-606.1 3.4-2.4 2.8 2.8-2.4c2.5-2.3 3.2-3.1 2.4-3.1-.2 0-1.4 1.2-2.8 2.7M140.2 271c0 1.4.2 1.9.5 1.2.2-.6.2-1.8 0-2.5-.3-.6-.5-.1-.5 1.3m667 0c0 1.4.2 1.9.5 1.2.2-.6.2-1.8 0-2.5-.3-.6-.5-.1-.5 1.3m-667 406c0 1.4.2 1.9.5 1.2.2-.6.2-1.8 0-2.5-.3-.6-.5-.1-.5 1.3m667 0c0 1.4.2 1.9.5 1.2.2-.6.2-1.8 0-2.5-.3-.6-.5-.1-.5 1.3m-29.3 67.7-2.4 2.8 2.8-2.4c1.5-1.4 2.7-2.6 2.7-2.8 0-.8-.8-.1-3.1 2.4m-608.4.3c1 1.1 2 2 2.3 2s-.3-.9-1.3-2-2-2-2.3-2 .3.9 1.3 2"/><path fill-opacity=".3" d="M140.5 474c0 110.8.1 156.2.2 100.8.2-55.5.2-146.1 0-201.5-.1-55.5-.2-10.1-.2 100.7m66.9-184c0 9.6.2 13.6.3 8.7.2-4.8.2-12.6 0-17.5-.1-4.8-.3-.8-.3 8.8m533 0c0 9.6.2 13.6.3 8.7.2-4.8.2-12.6 0-17.5-.1-4.8-.3-.8-.3 8.8m67.1 184c0 110.8.1 156.2.2 100.8.2-55.5.2-146.1 0-201.5-.1-55.5-.2-10.1-.2 100.7m-600 50.5c0 83 .1 117.2.2 75.8.2-41.3.2-109.3 0-151-.1-41.7-.2-7.9-.2 75.2m533 0c0 83 .1 117.2.2 75.8.2-41.3.2-109.3 0-151-.1-41.7-.2-7.9-.2 75.2m-436.5-6c11.8 11.8 21.7 21.5 22 21.5s-9.2-9.7-21-21.5-21.7-21.5-22-21.5 9.2 9.7 21 21.5m60 79.2-33.5 33.8 33.8-33.5c18.5-18.4 33.7-33.6 33.7-33.7 0-.7-2.9 2.1-34 33.4"/><g fill="#80FF40" stroke-width="0"><path d="M226.5 175c-21.8 3.3-42.6 14-57.5 29.6-12.4 13-20.5 27.4-25.2 44.4l-2.3 8.5v433l2.3 8.5c10.3 38 41.8 66.9 80.1 73.4 8.5 1.4 34.2 1.6 250.1 1.6 217 0 241.6-.2 250.1-1.6 25.4-4.4 47.5-17.8 63.1-38.4 6.4-8.4 14.1-24.2 17-35l2.3-8.5v-433l-2.3-8.5c-9.8-35.7-36.1-61.8-73-72.3l-7.7-2.2-246-.1c-135.3-.1-248.2.2-251 .6m492.9 68c7.6 2.9 13.9 8.8 17.8 16.8l3.3 6.7.4 20.2.3 20.3H206.8l.4-20.3c.3-18.3.6-20.7 2.6-25.1 3.1-6.8 6.4-11 11.7-14.6 9.2-6.3-10-5.9 252.2-5.9 239.2-.1 240.2-.1 245.7 1.9m21.4 284.7-.3 153.8-2.8 6c-3.6 7.7-11 14.7-18.3 17.5l-5.5 2-241.2-.2-241.2-.3-4.6-2.3c-7.4-3.6-12.5-8.7-16.1-16l-3.3-6.7-.3-153.7L207 374h534z"/><path d="M295.3 443.1c-7.1 2.7-14.6 9.7-18 16.7-2.4 4.9-2.8 6.9-2.8 14.2 0 13.5 1.2 15.3 28.9 43l23.6 23.4-23.8 24.1c-26 26.1-27.8 28.7-28.9 39.9-1.5 16.5 9.2 31.1 25.9 35.2 7.8 1.9 14.8 1.1 22.3-2.7 2.9-1.4 17.1-15 42.3-40.3 35.3-35.4 38.1-38.5 40.1-43.9 2.8-7.6 2.8-16.8 0-24.4-2-5.4-4.9-8.5-39.8-43.6-42.7-42.9-42.8-43-56.6-43.4-6.1-.2-9.2.2-13.2 1.8"/></g></svg>        <div class="icon-label">CMD</div>
      </div>
    </div>
    <div id="taskbar">
      <div id="start-menu">LithiumOS</div>
      <div id="clock"></div>
    </div>
  </div>
  
  <div id="app-windows"></div>

<script>
let files = {};
let userTimezone = 'UTC'; // Default timezone
let openWindows = [];
let currentMediaIndex = 0;
let commandLog = JSON.parse(localStorage.getItem('commandLog')) || [];

function fetchUserTimezone() {
  fetch('https://ipapi.co/json/')
    .then(response => response.json())
    .then(data => {
      userTimezone = data.timezone;
      updateClock(); // Update clock immediately after getting the timezone
    })
    .catch(error => {
      console.error('Error fetching timezone:', error);
    });
}

function updateClock() {
  const now = new Date();
  const options = {
    timeZone: userTimezone,
    hour: 'numeric',
    minute: 'numeric',
    second: 'numeric',
    hour12: true
  };
  const timeString = now.toLocaleString('en-US', options);
  document.getElementById('clock').textContent = timeString;
}

function openApp(appName) {
  const existingWindow = openWindows.find(id => id.includes(appName.replace(' ', '')));
  if (existingWindow) {
    bringToFront(existingWindow);
    return;
  }

  const appWindow = document.createElement('div');
  appWindow.className = 'app-window';
  appWindow.id = `app-${appName.replace(' ', '')}-${Date.now()}`;
  appWindow.style.display = 'flex';
  appWindow.innerHTML = `
    <div class="app-header">
      <h2>${appName.charAt(0).toUpperCase() + appName.slice(1).replace(/([A-Z])/g, ' $1').trim()}</h2>
      <div class="app-controls">
        <button class="app-control" onclick="minimizeApp('${appWindow.id}')">-</button>
        <button class="app-control" onclick="closeApp('${appWindow.id}')">&times;</button>
      </div>
    </div>
    <div class="app-content"></div>
    <div class="resize-handle top-left"></div>
    <div class="resize-handle top-right"></div>
    <div class="resize-handle bottom-left"></div>
    <div class="resize-handle bottom-right"></div>
    <div class="resize-handle top"></div>
    <div class="resize-handle bottom"></div>
    <div class="resize-handle left"></div>
    <div class="resize-handle right"></div>
  `;

  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
      closeApp(appWindow.id);
    }
  });
  document.getElementById('app-windows').appendChild(appWindow);
  openWindows.push(appWindow.id);
  
  const appContent = appWindow.querySelector('.app-content');
  
  switch(appName) {
    case 'app store':
      appContent.innerHTML = '<h3>Welcome to the App Store</h3><p>Browse and download apps here.</p>';
      break;
    case 'games':
      fetch('https://fiddle.jshell.net/FatGarfield777/v9Ldjqr3/70/show/?editor_console=#')
        .then(response => response.text())
        .then(html => {
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          const content = doc.body.innerHTML;
          appContent.innerHTML = content;
        })
        .catch(error => {
          console.error('Error fetching game content:', error);
          appContent.innerHTML = '<h3>Error</h3><p>We were unable to show this content.</p>';
        });
      break;
    case 'files':
      displayFiles(appContent);
      break;
    case 'CMD':
      displayCMD(appContent);
      break;
  }

  makeWindowDraggable(appWindow);
  makeWindowResizable(appWindow);
  bringToFront(appWindow.id);
}

function bringToFront(appId) {
  const appWindow = document.getElementById(appId);
  appWindow.style.zIndex = Math.max(...Array.from(document.querySelectorAll('.app-window')).map(w => parseInt(w.style.zIndex || 0))) + 1;
}

function makeWindowDraggable(appWindow) {
  const header = appWindow.querySelector('.app-header');
  let isDragging = false;
  let startX, startY, startLeft, startTop;

  header.addEventListener('mousedown', startDragging);
  document.addEventListener('mousemove', drag);
  document.addEventListener('mouseup', stopDragging);

  function startDragging(e) {
    isDragging = true;
    startX = e.clientX;
    startY = e.clientY;
    startLeft = appWindow.offsetLeft;
    startTop = appWindow.offsetTop;
  }

  function drag(e) {
    if (!isDragging) return;
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;
    appWindow.style.left = `${startLeft + dx}px`;
    appWindow.style.top = `${startTop + dy}px`;
  }

  function stopDragging() {
    isDragging = false;
  }
}

function makeWindowResizable(appWindow) {
  const resizeHandles = appWindow.querySelectorAll('.resize-handle');
  let isResizing = false;
  let startX, startY, startWidth, startHeight, startLeft, startTop;

  resizeHandles.forEach(handle => {
    handle.addEventListener('mousedown', startResize);
  });

  document.addEventListener('mousemove', resize);
  document.addEventListener('mouseup', stopResize);

  function startResize(e) {
    isResizing = true;
    startX = e.clientX;
    startY = e.clientY;
    startWidth = appWindow.offsetWidth;
    startHeight = appWindow.offsetHeight;
    startLeft = appWindow.offsetLeft;
    startTop = appWindow.offsetTop;
  }

  function resize(e) {
    if (!isResizing) return;
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;
    const handle = e.target;

    if (handle.classList.contains('top-left')) {
      appWindow.style.width = `${Math.max(300, startWidth - dx)}px`;
      appWindow.style.height = `${Math.max(200, startHeight - dy)}px`;
      appWindow.style.left = `${startLeft + dx}px`;
      appWindow.style.top = `${startTop + dy}px`;
    } else if (handle.classList.contains('top-right')) {
      appWindow.style.width = `${Math.min(window.innerWidth * 0.9, startWidth + dx)}px`;
      appWindow.style.height = `${Math.max(200, startHeight - dy)}px`;
      appWindow.style.top = `${startTop + dy}px`;
    } else if (handle.classList.contains('bottom-left')) {
      appWindow.style.width = `${Math.max(300, startWidth - dx)}px`;
      appWindow.style.height = `${Math.min(window.innerHeight * 0.9, startHeight + dy)}px`;
      appWindow.style.left = `${startLeft + dx}px`;
    } else if (handle.classList.contains('bottom-right')) {
      appWindow.style.width = `${Math.min(window.innerWidth * 0.9, startWidth + dx)}px`;
      appWindow.style.height = `${Math.min(window.innerHeight * 0.9, startHeight + dy)}px`;
    } else if (handle.classList.contains('top')) {
      appWindow.style.height = `${Math.max(200, startHeight - dy)}px`;
      appWindow.style.top = `${startTop + dy}px`;
    } else if (handle.classList.contains('bottom')) {
      appWindow.style.height = `${Math.min(window.innerHeight * 0.9, startHeight + dy)}px`;
    } else if (handle.classList.contains('left')) {
      appWindow.style.width = `${Math.max(300, startWidth - dx)}px`;
      appWindow.style.left = `${startLeft + dx}px`;
    } else if (handle.classList.contains('right')) {
      appWindow.style.width = `${Math.min(window.innerWidth * 0.9, startWidth + dx)}px`;
    }
  }

  function stopResize() {
    isResizing = false;
  }
}
function closeApp(appId) {
  const appWindow = document.getElementById(appId);
  appWindow.remove();
  openWindows = openWindows.filter(id => id !== appId);
}

function displayFiles(appContent) {
  appContent.innerHTML = '<h3>File System</h3>';
  
  const fileList = document.createElement('div');
  fileList.style.display = 'flex';
  fileList.style.flexWrap = 'wrap';
  fileList.style.gap = '10px';

  for (const fileName in files) {
    const fileItem = document.createElement('div');
    fileItem.className = 'file-item';
    fileItem.innerHTML = `
      <input type="checkbox" class="file-checkbox stylish-input">
      <img src="${files[fileName]}" alt="${fileName}">
      <span>${fileName}</span>
    `;
    fileItem.ondblclick = () => openFile(fileName);
    fileList.appendChild(fileItem);
  }
  
  appContent.appendChild(fileList);
  
  const fileForm = document.createElement('form');
  fileForm.innerHTML = `
    <input type="file" id="fileUpload" class="stylish-file-input">
    <label for="fileUpload" class="stylish-file-label">Choose File</label>
    <button type="button" class="stylish-button" onclick="uploadFile()">Upload File</button>
  `;
  appContent.appendChild(fileForm);
  
  const fileActions = document.createElement('div');
  fileActions.innerHTML = `
    <button class="stylish-button" onclick="deleteSelectedFiles()">Delete Selected</button>
    <button class="stylish-button" onclick="renameSelectedFiles()">Rename Selected</button>
    <button class="stylish-button" onclick="downloadSelectedFiles()">Download Selected</button>
  `;
  appContent.appendChild(fileActions);
  
  const saveCodeArea = document.createElement('div');
  saveCodeArea.innerHTML = `
    <h4>Save/Load Files</h4>
    <button class="stylish-button" onclick="generateSaveCode()">Generate Save Code</button>
    <input type="text" id="loadCode" class="stylish-input" placeholder="Enter save code">
    <button class="stylish-button" onclick="loadFromCode()">Load Files</button>
  `;
  appContent.appendChild(saveCodeArea);
}

function uploadFile() {
  const fileInput = document.getElementById('fileUpload');
  const file = fileInput.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      files[file.name] = e.target.result;
      localStorage.setItem('files', JSON.stringify(files));
      displayFiles(document.querySelector('.app-content'));
    };
    reader.readAsDataURL(file);
  }
}

function openFile(fileName) {
  const fileContent = files[fileName];
  openApp('file viewer');
  const appWindow = document.getElementById(`app-fileviewer-${Date.now()}`);
  const appContent = appWindow.querySelector('.app-content');
  appContent.innerHTML = `<h3>${fileName}</h3><img src="${fileContent}" alt="${fileName}" style="max-width: 100%; max-height: 100%;">`;
}

function downloadFile(fileName) {
  const fileContent = files[fileName];
  const blob = new Blob([fileContent], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = fileName;
  a.click();
  URL.revokeObjectURL(url);
}

function renameFile(fileName) {
  const newFileName = prompt('Enter new file name:', fileName);
  if (newFileName && newFileName !== fileName) {
    files[newFileName] = files[fileName];
    delete files[fileName];
    localStorage.setItem('files', JSON.stringify(files));
    displayFiles(document.querySelector('.app-content'));
  }
}

function deleteSelectedFiles() {
  const checkboxes = document.querySelectorAll('.file-checkbox:checked');
  checkboxes.forEach(checkbox => {
    const fileName = checkbox.nextElementSibling.nextElementSibling.textContent;
    delete files[fileName];
  });
  localStorage.setItem('files', JSON.stringify(files));
  displayFiles(document.querySelector('.app-content'));
}

function renameSelectedFiles() {
  const checkboxes = document.querySelectorAll('.file-checkbox:checked');
  checkboxes.forEach(checkbox => {
    const fileName = checkbox.nextElementSibling.nextElementSibling.textContent;
    renameFile(fileName);
  });
}

function downloadSelectedFiles() {
  const checkboxes = document.querySelectorAll('.file-checkbox:checked');
  checkboxes.forEach(checkbox => {
    const fileName = checkbox.nextElementSibling.nextElementSibling.textContent;
    downloadFile(fileName);
  });
}
function generateSaveCode() {
  const saveCode = btoa(JSON.stringify(files));
  navigator.clipboard.writeText(saveCode).then(() => {
    alert(`Your save code has been copied to the clipboard: ${saveCode}`);
  }).catch(err => {
    alert('Failed to copy save code to clipboard.');
  });
}

function loadFromCode() {
  const loadCode = document.getElementById('loadCode').value;
  try {
    files = JSON.parse(atob(loadCode));
    localStorage.setItem('files', JSON.stringify(files));
    displayFiles(document.querySelector('.app-content'));
    alert('Files loaded successfully!');
  } catch (error) {
    alert('Invalid save code. Please try again.');
  }
}
function displayCMD(appContent) {
  appContent.innerHTML = `
    <div id="command-output" style="color: var(--primary-color);">Welcome to CMD!</div>
    <div style="display: flex; align-items: center; position: absolute; bottom: 0; width: 100%; padding: 10px; box-sizing: border-box;">
      <span style="color: var(--primary-color); margin-right: 5px;">&gt;</span>
      <input type="text" id="command-input" class="stylish-input" style="flex-grow: 1; outline: none;">
    </div>
    <div style="color: var(--primary-color); background: var(--primary-color); height: 2px; margin-top: 10px; position: absolute; bottom: 40px; width: 100%;"></div> <!-- This line creates the green line -->
  `;

  const commandOutput = appContent.querySelector('#command-output');
  commandLog.forEach(log => {
    const logEntry = document.createElement('div');
    logEntry.textContent = log;
    commandOutput.appendChild(logEntry);
  });

  const commandInput = appContent.querySelector('#command-input');
  commandInput.addEventListener('keydown', function(event) {
    if (event.key === 'Enter') {
      const command = commandInput.value.trim();
      const newOutput = document.createElement('div');
      newOutput.textContent = `> ${command}`;
      commandOutput.appendChild(newOutput);
      commandLog.push(`> ${command}`);

      if (command.startsWith('tagger.')) {
        const name = command.split('.')[1];
        posthog.capture(name);
        const response = document.createElement('div');
        response.textContent = `posthog.capture('${name}') executed`;
        commandOutput.appendChild(response);
        commandLog.push(`posthog.capture('${name}') executed`);
      } else if (command === 'ohio gyatt' || command === 'ohiogyatt') {
        const response = document.createElement('div');
        response.textContent = 'rizz';
        commandOutput.appendChild(response);
        commandLog.push('rizz');
      } else if (command === 'clear' || command === 'clr') {
        commandOutput.innerHTML = '';
        commandLog = [];
      }

      localStorage.setItem('commandLog', JSON.stringify(commandLog));
      commandInput.value = '';
      appContent.scrollTop = appContent.scrollHeight;
    }
  });
}

// Initialize
fetchUserTimezone(); // Fetch user's timezone on page load
setInterval(updateClock, 1000);
updateClock();

// Load saved files from localStorage
const savedFiles = localStorage.getItem('files');
if (savedFiles) {
  files = JSON.parse(savedFiles);
}
</script>
</body></html>